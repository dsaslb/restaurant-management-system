<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ê·¼ë¡œê³„ì•½ì„œ</title>
    <style>
        body { font-family: 'ë‚˜ëˆ”ê³ ë”•', sans-serif; padding: 20px; }
        h2 { text-align: center; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        td, th { border: 1px solid #333; padding: 10px; }
        .signature { margin-top: 40px; }
        .pdf-button {
            display: inline-block;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin: 20px 0;
            font-size: 16px;
        }
        .pdf-button:hover {
            background-color: #45a049;
        }
        .button-container {
            text-align: center;
            margin: 20px 0;
        }
        .warning-banner {
            background-color: #fff3cd;
            color: #856404;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ffeeba;
            border-radius: 4px;
            text-align: center;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="button-container">
        <a href="/contract/{{ user_id }}/pdf" target="_blank" class="pdf-button">
            ğŸ“„ ê³„ì•½ì„œ PDFë¡œ ì €ì¥í•˜ê¸°
        </a>
    </div>

    <div class="contract-header">
        <h1>ê·¼ë¡œê³„ì•½ì„œ</h1>
        {% if warning %}
        <div class="warning-banner">
            {{ warning }}
        </div>
        {% endif %}
    </div>

    <h2>ê·¼ë¡œê³„ì•½ì„œ</h2>
    <p>ê·¼ë¡œê¸°ì¤€ë²• ì œ17ì¡° ë° ê´€ë ¨ ë²•ë ¹ì— ë”°ë¼ ë‹¤ìŒê³¼ ê°™ì´ ê·¼ë¡œê³„ì•½ì„ ì²´ê²°í•©ë‹ˆë‹¤.</p>

    <table>
        <tr><th>ê·¼ë¡œì ì„±ëª…</th><td>{{name}}</td><th>ì£¼ë¯¼ë“±ë¡ë²ˆí˜¸</th><td>{{rrn}}</td></tr>
        <tr><th>ì£¼ì†Œ</th><td colspan="3">{{address}}</td></tr>
        <tr><th>ê³ ìš©í˜•íƒœ</th><td>{{pay_type}}ì œ</td><th>ì‹œê¸‰/ì›”ê¸‰</th><td>{{wage}}ì›</td></tr>
        <tr><th colspan="4">ê¸‰ì—¬ ì„¤ëª…</th></tr>
<tr>
    <td colspan="4">
        {% if pay_type == 'ì‹œê¸‰' %}
            ë³¸ ê³„ì•½ì€ ì‹œê¸‰ì œë¡œ, ê·¼ë¡œìì˜ ì‹¤ì œ ê·¼ë¬´ì‹œê°„ì— ë”°ë¼ ê¸‰ì—¬ê°€ ì‚°ì •ë©ë‹ˆë‹¤. ì£¼íœ´ìˆ˜ë‹¹ì€ ì£¼ 15ì‹œê°„ ì´ìƒ, 5ì¼ ì´ìƒ ê·¼ë¬´ ì‹œ ë°œìƒí•©ë‹ˆë‹¤.
        {% elif pay_type == 'ì›”ê¸‰' %}
            ë³¸ ê³„ì•½ì€ ì›”ê¸‰ì œë¡œ, ê³ ì •ëœ ê¸‰ì—¬ê°€ ë§¤ì›” ì§€ê¸‰ë˜ë©° ì—°ì°¨Â·ì£¼íœ´ìˆ˜ë‹¹ì€ ë³„ë„ë¡œ ì •ì‚°ë©ë‹ˆë‹¤.
        {% elif pay_type == 'ì£¼ê¸‰' %}
            ë³¸ ê³„ì•½ì€ ì£¼ê¸‰ì œë¡œ, ë§¤ì£¼ ê·¼ë¬´í•œ ì‹œê°„ê³¼ ì¼ì •ì— ë”°ë¼ ì£¼ë‹¨ìœ„ë¡œ ê¸‰ì—¬ê°€ ì§€ê¸‰ë©ë‹ˆë‹¤.
        {% else %}
            ê·¼ë¬´ í˜•íƒœ ì •ë³´ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤.
        {% endif %}
    </td>
</tr>
        <tr><th>ê·¼ë¡œê°œì‹œì¼</th><td>{{start_date}}</td><th>ê³„ì•½ê¸°ê°„</th><td>{{contract_term}}</td></tr>
        <tr><th>ê·¼ë¡œì‹œê°„</th><td>{{work_time}}</td><th>íœ´ê²Œì‹œê°„</th><td>{{break_time}}</td></tr>
        <tr><th>ê·¼ë¬´ìš”ì¼</th><td colspan="3">{{work_days}}</td></tr>
        <tr><th>ì§€ê¸‰ì¼</th><td>{{pay_day}}</td><th>ì§€ê¸‰ë°©ë²•</th><td>{{pay_method}}</td></tr>
        <tr><th>ì—°ì°¨/ì£¼íœ´ìˆ˜ë‹¹</th><td colspan="3">
            {{pay_type}}ì œì— ë”°ë¼ ì£¼íœ´ìˆ˜ë‹¹{{holiday_note}} ë° ì—°ì°¨ìˆ˜ë‹¹{{annual_note}}ì´ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </td></tr>
    </table>

    <div class="signature-section">
        <div class="employee-signature">
            <h3>ì§ì› ì„œëª…</h3>
            {% if employee_signature %}
                <img src="{{ employee_signature }}" height="100">
            {% else %}
                <canvas id="employeeCanvas" width="300" height="100" style="border:1px solid #000;"></canvas>
                <button onclick="saveSignature('employee')">ì„œëª… ì €ì¥</button>
            {% endif %}
        </div>
        
        <div class="employer-signature">
            <h3>ê³ ìš©ì£¼ ì„œëª…</h3>
            {% if employer_signature %}
                <img src="{{ employer_signature }}" height="100">
            {% else %}
                <canvas id="employerCanvas" width="300" height="100" style="border:1px solid #000;"></canvas>
                <button onclick="saveSignature('employer')">ì„œëª… ì €ì¥</button>
            {% endif %}
        </div>
    </div>

    <div class="download-section" style="margin-top: 20px; text-align: center;">
        <a href="/contract/{{ user_id }}/pdf" class="download-button" style="display: inline-block; padding: 10px 20px; background-color: #4CAF50; color: white; text-decoration: none; border-radius: 5px;">
            PDF ë‹¤ìš´ë¡œë“œ
        </a>
    </div>

    <script>
    function enableCanvasSave(canvasId) {
        const canvas = document.getElementById(canvasId);
        let drawing = false;
        const ctx = canvas.getContext("2d");

        canvas.addEventListener("mousedown", () => {
            drawing = true;
            ctx.beginPath();
        });
        canvas.addEventListener("mouseup", () => drawing = false);
        canvas.addEventListener("mousemove", (e) => {
            if (!drawing) return;
            const rect = canvas.getBoundingClientRect();
            ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
            ctx.stroke();
        });
    }

    enableCanvasSave("employeeCanvas");
    enableCanvasSave("employerCanvas");

    function saveSignature(who) {
        const canvas = document.getElementById(who + "Canvas");
        const dataURL = canvas.toDataURL("image/png");

        fetch("/save_signature", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                "image_data": dataURL,
                "who": who,
                "user_id": "{{ user_id }}"
            })
        })
        .then(res => res.json())
        .then(data => {
            alert(data.message);
            location.reload();  // ì €ì¥ í›„ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
        });
    }
    </script>
</body>
</html> 

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ê·¼ë¡œê³„ì•½ì„œ</title>
</head>
<body style="font-family: Arial, sans-serif; padding: 30px;">
  <h2>ê·¼ë¡œê³„ì•½ì„œ</h2>
  <p>ì„±ëª…: {{ user.name }}</p>
  <p>ìƒë…„ì›”ì¼: {{ user.birth_date }}</p>
  <p>ì „í™”ë²ˆí˜¸: {{ user.phone }}</p>
  <p>ê³„ì•½ê¸°ê°„: {{ contract.start_date }} ~ {{ contract.end_date }}</p>
  <p>ì„ê¸ˆ: {{ contract.wage }}ì› / {{ contract.pay_type }}</p>

  <hr>
  <p>ì „ì ì„œëª…:</p>
  {% if contract.signature %}
    <img src="{{ url_for('static', filename='signatures/' + contract.signature) }}" width="200">
  {% else %}
    <form method="POST" enctype="multipart/form-data">
      <input type="file" name="signature" accept="image/*" required>
      <button type="submit">ì„œëª… ì œì¶œ</button>
    </form>
  {% endif %}
</body>
</html>
